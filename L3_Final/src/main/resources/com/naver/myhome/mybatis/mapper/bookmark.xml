<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.naver.myhome.mybatis.mapper.BookmarkMapper">

	<select id="checkBookmark" resultType="int">
        select count(*)
        from bookmark
       	where issue_id = #{issueId}
    	and user_id = #{userId}
    </select>
    
    <select id = "countBookmark" resultType="int">
    	select count(*)
    	from bookmark
    	where user_id = #{userId}
    </select>
    
    <select id = "getBookmarkList" resultType="bookmark">
    	SELECT i.TYPE, i.SUBJECT,p.TITLE , u.NAME, b.regDate
		FROM bookmark b
   		INNER JOIN issue i ON i.ID =  b.ISSUE_ID
    	INNER JOIN project p ON i.PROJECT_ID = p.ID
    	INNER JOIN users u ON i.CREATE_USER = u.ID
		WHERE b.user_id = #{userId}
    </select>
    
 	<insert id="addBookmark">
 		insert into bookmark
 		values(bookmark_seq.nextval, #{issueId}, #{userId}, sysdate)
 	</insert>
    
    <delete id="deleteBookmark">
    	delete
    	from bookmark
    	where issue_id = #{issueId}
    	and user_id = #{userId}
    </delete>

</mapper>