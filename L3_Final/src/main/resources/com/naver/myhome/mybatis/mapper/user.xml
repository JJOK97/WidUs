<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.naver.myhome.mybatis.mapper.UserMapper">


	<!-- 지니 -->
	<select id="isEmail" resultType="user" parameterType="String"><!-- Member class를 별칭 -->
		select * from users where  email = #{user_email}
	</select>
   
   <select id = "isId" resultType = "user">
      SELECT u.pic, u.password,u.email, u.name, u.phone, c.name AS company_name
      FROM users u
      LEFT JOIN company c ON u.id = c.user_id
      WHERE u.email = #{email}
   </select>
   
   <update id = "update" parameterType = "user">
      update users
      set pic = #{pic},
      name = #{name},
         phone = #{phone}
      WHERE email = #{email}
      
   </update>

   <select id="checkPwd">
      select password 
      from users
      where email = #{email}
   </select>
   
   <update id="updatePwd">
      update users
      set password =#{newPwd}
      where email = #{email}
   </update>
   
   <delete id="delete" >
      delete from users
      where email =#{email}
   </delete>
   
   <!-- /지니 -->
	
	<!-- #########################################주영###################################### START  -->
	<select id="selectByMail" resultType="int" parameterType="String">
		select count(*) from users where email = #{email}
	</select>
	
	<select id="getUserId" resultType="int">
		select id from users where email = #{email}
	</select>
	
	<insert id="insert" parameterType="user">
		insert into users
		(id,email,password,name,company_invited,COMPANY_STATUS)
		values
		(user_id.nextval,#{email},#{password},#{name},'','')
	</insert>
	
	<select id="getEmplyeeInfoById" parameterType="user" resultType="user">
		select ID, USER_ID , COMPANY_ID ,STATUS, AUTH, DEPARTMENT, POSITION , VISIT_COUNT FROM EMPLOYEE WHERE USER_ID = #{email};
	</select>
	
	<update id="updateUserInfo" parameterType="user">
		UPDATE USERS SET 
				EMAIL = #{email}, 
                NAME = #{name},
                COMPANY_INVITED = #{companyInvited},
                COMPANY_STATUS = #{companyStatus}
        WHERE ID = #{id}
	</update>  
	
	
	
	<!-- #########################################주영###################################### END  -->

</mapper>